<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" sizes="32x32" href="/Screenshot 2025-09-09 221052.png">
<link rel="icon" type="image/png" sizes="16x16" href="/Screenshot 2025-09-09 221052.png">
    <title>Analyze Crop Image</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style for the hidden file input */
        .hidden-input {
            display: none;
        }
        /* A subtle transition for the drop zone highlight */
        #drop-zone {
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center h-screen">

    <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg m-4 p-6 md:p-8 relative">
        <a href="chat.html" class="absolute top-4 left-5 text-gray-400 hover:text-gray-700 transition" title="Go Back">
            <i class="fas fa-times text-2xl"></i>
        </a>
        
        <div class="text-center">
            
            <div id="upload-ui">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Analyze a Plant or Soil Image</h2>
                <p class="text-gray-500 mb-6">Upload a clear photo of the affected plant, leaf, or soil for an AI-powered analysis.</p>

                <div id="drop-zone" class="border-2 border-dashed border-gray-300 rounded-lg p-8 cursor-pointer bg-gray-50 hover:bg-gray-100">
                    <div class="flex flex-col items-center">
                        <i class="fas fa-cloud-upload-alt text-5xl text-green-500 mb-4"></i>
                        <p class="text-gray-700 font-semibold">Drag & drop your image here</p>
                        <p class="text-gray-500 text-sm mt-1">or</p>
                        <label for="file-input" class="mt-4 bg-white border border-gray-300 text-gray-700 font-semibold py-2 px-5 rounded-lg hover:bg-gray-50 cursor-pointer shadow-sm">
                            Browse Files
                        </label>
                        <input type="file" id="file-input" class="hidden-input" accept="image/*">
                    </div>
                </div>

                <div class="my-6 flex items-center">
                    <div class="flex-grow border-t border-gray-200"></div>
                    <span class="flex-shrink mx-4 text-gray-400 text-sm">FOR MOBILE</span>
                    <div class="flex-grow border-t border-gray-200"></div>
                </div>
                
                <label for="camera-input" class="w-full bg-green-500 text-white font-bold py-3 px-5 rounded-lg hover:bg-green-600 cursor-pointer shadow-md flex items-center justify-center gap-3">
                    <i class="fas fa-camera text-xl"></i>
                    <span>Use Camera</span>
                </label>
                <input type="file" id="camera-input" class="hidden-input" accept="image/*" capture="environment">
            </div>

            <div id="preview-ui" class="hidden">
                 <h2 class="text-2xl font-bold text-gray-800 mb-4">Image Preview</h2>
                 <div class="relative group">
                    <img id="image-preview" src="" alt="Image Preview" class="rounded-lg max-h-64 mx-auto shadow-md">
                    <button id="remove-btn" class="absolute top-2 right-2 bg-black bg-opacity-50 text-white rounded-full h-8 w-8 flex items-center justify-center opacity-0 group-hover:opacity-100 transition" title="Remove Image">
                        <i class="fas fa-times"></i>
                    </button>
                 </div>
                 <div class="mt-4 text-left bg-gray-50 p-3 rounded-md">
                    <p class="text-sm font-medium text-gray-800 truncate" id="file-name"></p>
                    <p class="text-xs text-gray-500" id="file-size"></p>
                 </div>
            </div>

            <div class="mt-8">
                <button id="analyze-btn" class="w-full bg-indigo-500 text-white font-bold py-3 px-5 rounded-lg hover:bg-indigo-600 shadow-md transition disabled:bg-gray-300 disabled:cursor-not-allowed disabled:shadow-none" disabled>
                    <i class="fas fa-microchip mr-2"></i>
                    Analyze with AI
                </button>
            </div>
        </div>
    </div>

    <script>
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const cameraInput = document.getElementById('camera-input');
        const uploadUI = document.getElementById('upload-ui');
        const previewUI = document.getElementById('preview-ui');
        const imagePreview = document.getElementById('image-preview');
        const fileNameEl = document.getElementById('file-name');
        const fileSizeEl = document.getElementById('file-size');
        const removeBtn = document.getElementById('remove-btn');
        const analyzeBtn = document.getElementById('analyze-btn');

        // Function to handle the file
        const handleFile = (file) => {
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    imagePreview.src = e.target.result;
                    fileNameEl.textContent = file.name;
                    fileSizeEl.textContent = `${(file.size / 1024).toFixed(1)} KB`;
                    
                    uploadUI.classList.add('hidden');
                    previewUI.classList.remove('hidden');
                    analyzeBtn.disabled = false;
                };
                reader.readAsDataURL(file);
            } else {
                alert('Please select an image file.');
            }
        };
        
        // Function to reset the UI
        const resetUI = () => {
            fileInput.value = '';
            cameraInput.value = '';
            imagePreview.src = '';
            uploadUI.classList.remove('hidden');
            previewUI.classList.add('hidden');
            analyzeBtn.disabled = true;
        };

        // Event Listeners for Drag and Drop
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('bg-green-50', 'border-green-500');
        });
        dropZone.addEventListener('dragleave', (e) => {
            e.preventDefault();
            dropZone.classList.remove('bg-green-50', 'border-green-500');
        });
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('bg-green-50', 'border-green-500');
            const file = e.dataTransfer.files[0];
            handleFile(file);
        });

        // Trigger file input click when drop zone is clicked
        dropZone.addEventListener('click', () => {
            fileInput.click();
        });

        // Event Listeners for file inputs
        fileInput.addEventListener('change', (e) => handleFile(e.target.files[0]));
        cameraInput.addEventListener('change', (e) => handleFile(e.target.files[0]));

        // Event Listener for remove button
        removeBtn.addEventListener('click', resetUI);
        
        // Event Listener for analyze button
        analyzeBtn.addEventListener('click', () => {
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Analyzing...';
            
            // Simulate AI analysis
            setTimeout(() => {
                alert('AI Analysis Complete!\n\n(This is a demonstration. In a real application, the results would be displayed here or you would be taken to a results page.)');
                analyzeBtn.innerHTML = '<i class="fas fa-microchip mr-2"></i> Analyze with AI';
                // Optionally reset after analysis
                // resetUI();
            }, 2500);
        });

    </script>
</body>
</html>